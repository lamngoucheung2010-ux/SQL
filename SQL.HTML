<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•¸æ“šåº«æ“ä½œæ¨¡æ“¬å™¨</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
        }
        
        .left-panel {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            border-right: 1px solid #eee;
        }
        
        .right-panel {
            flex: 2;
            min-width: 500px;
            padding: 20px;
        }
        
        .panel-title {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        .tables-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .table-card {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #3498db;
            box-shadow: 0 3px 5px rgba(0,0,0,0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .table-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        
        .table-name {
            font-weight: bold;
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .table-columns {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .table-rows {
            font-size: 0.9rem;
            color: #27ae60;
            font-weight: bold;
        }
        
        .input-area {
            margin-bottom: 20px;
        }
        
        .sql-input {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: monospace;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 15px;
        }
        
        .sql-input:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #27ae60;
        }
        
        .btn-help {
            background-color: #9b59b6;
            color: white;
        }
        
        .btn-help:hover {
            background-color: #8e44ad;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .result-container {
            margin-top: 20px;
        }
        
        .result-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .result-area {
            min-height: 200px;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #f8f9fa;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        .error-message {
            background-color: #ffeaea;
            color: #c0392b;
            border-left: 4px solid #c0392b;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .success-message {
            background-color: #eaffea;
            color: #27ae60;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        .sql-examples {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .example-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #3498db;
        }
        
        .example-query {
            background-color: #e8f4fc;
            padding: 8px 10px;
            border-radius: 5px;
            margin-bottom: 8px;
            font-family: monospace;
            cursor: pointer;
            border: 1px solid #d1e7f5;
        }
        
        .example-query:hover {
            background-color: #d1e7f5;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            margin-bottom: 20px;
        }
        
        th {
            background-color: #3498db;
            color: white;
            padding: 12px 15px;
            text-align: left;
        }
        
        td {
            padding: 10px 15px;
            border-bottom: 1px solid #ddd;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tr:hover {
            background-color: #f1f7fd;
        }
        
        .query-count {
            font-style: italic;
            color: #7f8c8d;
            margin-top: 10px;
        }
        
        .highlight {
            background-color: #fffacd;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .left-panel {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“Š æ•¸æ“šåº«æ“ä½œæ¨¡æ“¬å™¨</h1>
            <p class="subtitle">æ¨¡æ“¬SQLæŸ¥è©¢æ“ä½œï¼Œæª¢æ¸¬éŒ¯èª¤ä¸¦è¼¸å‡ºçµæœ</p>
        </header>
        
        <div class="main-content">
            <div class="left-panel">
                <h2 class="panel-title">ğŸ“‹ æ•¸æ“šåº«è¡¨æ ¼</h2>
                
                <div class="tables-grid">
                    <div class="table-card">
                        <div class="table-name">Classes è¡¨</div>
                        <div class="table-columns">æ¬„ä½: ClassID, ClassName, Room</div>
                        <div class="table-rows">3 ç­†è¨˜éŒ„</div>
                    </div>
                    
                    <div class="table-card">
                        <div class="table-name">Courses è¡¨</div>
                        <div class="table-columns">æ¬„ä½: CourseID, CourseName, Credits</div>
                        <div class="table-rows">4 ç­†è¨˜éŒ„</div>
                    </div>
                    
                    <div class="table-card">
                        <div class="table-name">Enrollments è¡¨</div>
                        <div class="table-columns">æ¬„ä½: EnrollmentID, StudentID, CourseID, Grade</div>
                        <div class="table-rows">8 ç­†è¨˜éŒ„</div>
                    </div>
                    
                    <div class="table-card">
                        <div class="table-name">Students è¡¨</div>
                        <div class="table-columns">æ¬„ä½: StudentID, Name, Age, ClassID</div>
                        <div class="table-rows">8 ç­†è¨˜éŒ„</div>
                    </div>
                </div>
                
                <div class="sql-examples">
                    <div class="example-title">ğŸ“ SQL æŸ¥è©¢ç¯„ä¾‹ (é»æ“Šä½¿ç”¨)</div>
                    <div class="example-query" onclick="useExample('SELECT * FROM Students')">SELECT * FROM Students</div>
                    <div class="example-query" onclick="useExample('SELECT Name, Age FROM Students WHERE Age > 16')">SELECT Name, Age FROM Students WHERE Age > 16</div>
                    <div class="example-query" onclick="useExample('SELECT * FROM Courses WHERE Credits = 3')">SELECT * FROM Courses WHERE Credits = 3</div>
                    <div class="example-query" onclick="useExample('SELECT StudentID, Grade FROM Enrollments WHERE Grade = \\'A\\'')">SELECT StudentID, Grade FROM Enrollments WHERE Grade = 'A'</div>
                    <div class="example-query" onclick="useExample('SELECT * FROM Classes WHERE Room = \\'Room 101\\'')">SELECT * FROM Classes WHERE Room = 'Room 101'</div>
                </div>
                
                <div class="sql-examples">
                    <div class="example-title">âš ï¸ éŒ¯èª¤ç¯„ä¾‹ (æª¢æ¸¬åŠŸèƒ½)</div>
                    <div class="example-query" onclick="useExample('SELECT * FROM NonExistentTable')">SELECT * FROM NonExistentTable</div>
                    <div class="example-query" onclick="useExample('SELECT InvalidColumn FROM Students')">SELECT InvalidColumn FROM Students</div>
                    <div class="example-query" onclick="useExample('SELECT * FROM Students WHERE InvalidCondition')">SELECT * FROM Students WHERE InvalidCondition</div>
                </div>
            </div>
            
            <div class="right-panel">
                <h2 class="panel-title">ğŸ” SQL æŸ¥è©¢è¼¸å…¥</h2>
                
                <div class="input-area">
                    <textarea class="sql-input" id="sqlInput" placeholder="è«‹è¼¸å…¥SQLæŸ¥è©¢æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼šSELECT * FROM Students"></textarea>
                    
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="executeQuery()">åŸ·è¡ŒæŸ¥è©¢</button>
                        <button class="btn btn-secondary" onclick="showAllTables()">é¡¯ç¤ºæ‰€æœ‰è¡¨æ ¼</button>
                        <button class="btn btn-help" onclick="showHelp()">å¹«åŠ©</button>
                        <button class="btn btn-danger" onclick="clearResults()">æ¸…é™¤çµæœ</button>
                    </div>
                </div>
                
                <div id="messageArea"></div>
                
                <div class="result-container">
                    <div class="result-title">
                        <h2 class="panel-title">ğŸ“Š æŸ¥è©¢çµæœ</h2>
                        <span id="resultCount"></span>
                    </div>
                    
                    <div class="result-area" id="resultArea">
                        <!-- æŸ¥è©¢çµæœå°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
                        è«‹è¼¸å…¥SQLæŸ¥è©¢æŒ‡ä»¤ä¸¦é»æ“Šã€ŒåŸ·è¡ŒæŸ¥è©¢ã€æŒ‰éˆ•
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>æ•¸æ“šåº«æ¨¡æ“¬å™¨ | æ”¯æ´è¡¨æ ¼: Classes, Courses, Enrollments, Students | æ”¯æ´æŒ‡ä»¤: SELECT</p>
        </footer>
    </div>

    <script>
        // æ•¸æ“šåº«è¡¨æ ¼æ•¸æ“š
        const database = {
            Classes: [
                { ClassID: 1, ClassName: '6A', Room: 'Room 101' },
                { ClassID: 2, ClassName: '6B', Room: 'Room 102' },
                { ClassID: 3, ClassName: '6C', Room: 'Room 103' }
            ],
            Courses: [
                { CourseID: 1, CourseName: 'Mathematics', Credits: 3 },
                { CourseID: 2, CourseName: 'English', Credits: 3 },
                { CourseID: 3, CourseName: 'Computer Science', Credits: 4 },
                { CourseID: 4, CourseName: 'Physics', Credits: 3 }
            ],
            Enrollments: [
                { EnrollmentID: 1, StudentID: 1, CourseID: 1, Grade: 'A' },
                { EnrollmentID: 2, StudentID: 1, CourseID: 2, Grade: 'B+' },
                { EnrollmentID: 3, StudentID: 1, CourseID: 3, Grade: 'A' },
                { EnrollmentID: 4, StudentID: 2, CourseID: 1, Grade: 'B' },
                { EnrollmentID: 5, StudentID: 2, CourseID: 3, Grade: 'A' },
                { EnrollmentID: 6, StudentID: 3, CourseID: 2, Grade: 'A' },
                { EnrollmentID: 7, StudentID: 3, CourseID: 4, Grade: 'B+' },
                { EnrollmentID: 8, StudentID: 4, CourseID: 1, Grade: 'C+' }
            ],
            Students: [
                { StudentID: 1, Name: 'Amy Wong', Age: 17, ClassID: 1 },
                { StudentID: 2, Name: 'Bob Chan', Age: 16, ClassID: 1 },
                { StudentID: 3, Name: 'Carol Lee', Age: 17, ClassID: 2 },
                { StudentID: 4, Name: 'David Lam', Age: 18, ClassID: 2 },
                { StudentID: 5, Name: 'Eva Ho', Age: 16, ClassID: 3 },
                { StudentID: 6, Name: 'Frank Yip', Age: 17, ClassID: 1 },
                { StudentID: 7, Name: 'Grace Tam', Age: 18, ClassID: 3 },
                { StudentID: 8, Name: 'Henry Ng', Age: 16, ClassID: 2 }
            ]
        };

        // è¡¨æ ¼çµæ§‹å®šç¾©
        const tableSchemas = {
            Classes: ['ClassID', 'ClassName', 'Room'],
            Courses: ['CourseID', 'CourseName', 'Credits'],
            Enrollments: ['EnrollmentID', 'StudentID', 'CourseID', 'Grade'],
            Students: ['StudentID', 'Name', 'Age', 'ClassID']
        };

        // ä½¿ç”¨ç¯„ä¾‹æŸ¥è©¢
        function useExample(sql) {
            document.getElementById('sqlInput').value = sql;
        }

        // é¡¯ç¤ºå¹«åŠ©ä¿¡æ¯
        function showHelp() {
            const helpText = `
æ”¯æ´çš„SQLæŒ‡ä»¤æ ¼å¼ï¼š
1. SELECT * FROM è¡¨å
2. SELECT æ¬„ä½1, æ¬„ä½2 FROM è¡¨å
3. SELECT æ¬„ä½1, æ¬„ä½2 FROM è¡¨å WHERE æ¢ä»¶

WHEREæ¢ä»¶æ”¯æ´ï¼š
- æ•¸å€¼æ¯”è¼ƒï¼šAge > 16, Credits = 3
- å­—ä¸²æ¯”è¼ƒï¼šName = 'Amy Wong', Room = 'Room 101'
- æ–‡å­—åŒ¹é…ï¼šGrade = 'A'

å¯ç”¨è¡¨æ ¼ï¼š
- Classes: ClassID, ClassName, Room
- Courses: CourseID, CourseName, Credits
- Enrollments: EnrollmentID, StudentID, CourseID, Grade
- Students: StudentID, Name, Age, ClassID

ç¯„ä¾‹æŸ¥è©¢ï¼š
- SELECT * FROM Students
- SELECT Name, Age FROM Students WHERE Age > 16
- SELECT * FROM Courses WHERE Credits = 3
- SELECT StudentID, Grade FROM Enrollments WHERE Grade = 'A'
            `;
            
            showMessage(helpText, 'info');
        }

        // é¡¯ç¤ºæ‰€æœ‰è¡¨æ ¼å…§å®¹
        function showAllTables() {
            let resultHTML = '';
            
            for (const tableName in database) {
                resultHTML += `<h3>${tableName} è¡¨</h3>`;
                resultHTML += generateTableHTML(tableName, database[tableName]);
                resultHTML += `<div class="query-count">å…± ${database[tableName].length} ç­†è¨˜éŒ„</div><br>`;
            }
            
            document.getElementById('resultArea').innerHTML = resultHTML;
            document.getElementById('resultCount').innerHTML = '';
            clearMessage();
        }

        // åŸ·è¡ŒSQLæŸ¥è©¢
        function executeQuery() {
            const sqlInput = document.getElementById('sqlInput').value.trim();
            
            if (!sqlInput) {
                showMessage('éŒ¯èª¤ï¼šSQLæŒ‡ä»¤ä¸èƒ½ç‚ºç©ºï¼', 'error');
                return;
            }
            
            const sqlUpper = sqlInput.toUpperCase();
            
            // æª¢æŸ¥æ˜¯å¦ç‚ºSELECTæŒ‡ä»¤
            if (!sqlUpper.startsWith('SELECT')) {
                showMessage('éŒ¯èª¤ï¼šç›®å‰åªæ”¯æ´ SELECT æŒ‡ä»¤ï¼', 'error');
                return;
            }
            
            try {
                // è§£æSQLæŒ‡ä»¤
                const parsedQuery = parseSQL(sqlInput);
                
                if (parsedQuery.error) {
                    showMessage(`âŒ ${parsedQuery.error}`, 'error');
                    return;
                }
                
                // é©—è­‰æŸ¥è©¢
                const validationError = validateQuery(parsedQuery);
                if (validationError) {
                    showMessage(`âŒ ${validationError}`, 'error');
                    return;
                }
                
                // åŸ·è¡ŒæŸ¥è©¢
                const result = executeParsedQuery(parsedQuery);
                
                // é¡¯ç¤ºçµæœ
                displayResult(parsedQuery, result);
                
            } catch (error) {
                showMessage(`åŸ·è¡ŒéŒ¯èª¤ï¼š${error.message}`, 'error');
            }
        }

        // è§£æSQLæŒ‡ä»¤
        function parseSQL(sqlCommand) {
            const sqlUpper = sqlCommand.toUpperCase();
            
            // ç°¡å–®è§£æSELECT...FROM...
            const selectIndex = sqlUpper.indexOf('SELECT');
            const fromIndex = sqlUpper.indexOf('FROM');
            
            if (fromIndex === -1) {
                return { error: 'éŒ¯èª¤ï¼šç¼ºå°‘ FROM å­å¥ï¼' };
            }
            
            // è§£æè¦é¸æ“‡çš„æ¬„ä½
            const selectPart = sqlCommand.substring(selectIndex + 6, fromIndex).trim();
            let columns = [];
            
            if (selectPart === '*') {
                columns = ['*'];
            } else {
                columns = selectPart.split(',').map(col => col.trim());
            }
            
            // è§£æè¡¨æ ¼åç¨±å’ŒWHEREå­å¥
            const remaining = sqlCommand.substring(fromIndex + 4).trim();
            const whereIndex = sqlUpper.indexOf('WHERE', fromIndex);
            
            let tableName, whereClause;
            
            if (whereIndex === -1) {
                tableName = remaining.replace(/;$/g, '').trim();
                whereClause = null;
            } else {
                tableName = sqlCommand.substring(fromIndex + 4, whereIndex).trim();
                whereClause = sqlCommand.substring(whereIndex + 5).replace(/;$/g, '').trim();
            }
            
            return {
                columns: columns,
                table: tableName,
                where: whereClause,
                error: null
            };
        }

        // é©—è­‰æŸ¥è©¢
        function validateQuery(parsedQuery) {
            const tableName = parsedQuery.table;
            
            // æª¢æŸ¥è¡¨æ ¼æ˜¯å¦å­˜åœ¨
            if (!database[tableName]) {
                return `éŒ¯èª¤ï¼šè¡¨æ ¼ '${tableName}' ä¸å­˜åœ¨ï¼<br>å¯ç”¨è¡¨æ ¼ï¼š${Object.keys(database).join(', ')}`;
            }
            
            // æª¢æŸ¥æ¬„ä½æ˜¯å¦å­˜åœ¨
            const columns = parsedQuery.columns;
            if (columns[0] !== '*') {
                const validColumns = tableSchemas[tableName];
                for (const col of columns) {
                    if (!validColumns.includes(col)) {
                        return `éŒ¯èª¤ï¼šè¡¨æ ¼ '${tableName}' ä¸­æ²’æœ‰æ¬„ä½ '${col}'ï¼<br>å¯ç”¨æ¬„ä½ï¼š${validColumns.join(', ')}`;
                    }
                }
            }
            
            // ç°¡å–®æª¢æŸ¥WHEREå­å¥æ ¼å¼
            if (parsedQuery.where) {
                const whereClause = parsedQuery.where;
                // æª¢æŸ¥æ˜¯å¦æœ‰åŸºæœ¬çš„æ¯”è¼ƒé‹ç®—ç¬¦
                const operators = ['=', '>', '<', '>=', '<=', '!='];
                const hasOperator = operators.some(op => whereClause.includes(op));
                
                if (!hasOperator) {
                    return `è­¦å‘Šï¼šWHEREå­å¥ '${whereClause}' å¯èƒ½åŒ…å«ç„¡æ•ˆçš„æ¯”è¼ƒé‹ç®—ç¬¦<br>æ”¯æ´çš„é‹ç®—ç¬¦ï¼š${operators.join(', ')}`;
                }
            }
            
            return null;
        }

        // åŸ·è¡Œè§£æå¾Œçš„æŸ¥è©¢
        function executeParsedQuery(parsedQuery) {
            const tableName = parsedQuery.table;
            let data = [...database[tableName]];
            
            // æ‡‰ç”¨WHEREéæ¿¾
            if (parsedQuery.where) {
                data = applyWhereFilter(data, parsedQuery.where, tableName);
            }
            
            // é¸æ“‡ç‰¹å®šæ¬„ä½
            if (parsedQuery.columns[0] !== '*') {
                const selectedColumns = parsedQuery.columns;
                data = data.map(row => {
                    const newRow = {};
                    selectedColumns.forEach(col => {
                        newRow[col] = row[col];
                    });
                    return newRow;
                });
            }
            
            return data;
        }

        // æ‡‰ç”¨WHEREæ¢ä»¶éæ¿¾
        function applyWhereFilter(data, whereClause, tableName) {
            return data.filter(row => {
                try {
                    // ç°¡å–®çš„WHEREæ¢ä»¶è§£æ
                    // æ”¯æ´ =, >, <, >=, <=, !=
                    const operators = ['>=', '<=', '!=', '=', '>', '<'];
                    let operator = '';
                    let conditionParts = [];
                    
                    for (const op of operators) {
                        if (whereClause.includes(op)) {
                            operator = op;
                            conditionParts = whereClause.split(op).map(part => part.trim());
                            break;
                        }
                    }
                    
                    if (conditionParts.length !== 2) {
                        return true; // å¦‚æœè§£æå¤±æ•—ï¼Œä¸éæ¿¾ä»»ä½•æ•¸æ“š
                    }
                    
                    const [field, value] = conditionParts;
                    
                    // æª¢æŸ¥æ¬„ä½æ˜¯å¦å­˜åœ¨
                    if (!tableSchemas[tableName].includes(field)) {
                        return true; // æ¬„ä½ä¸å­˜åœ¨ï¼Œä¸éæ¿¾
                    }
                    
                    // è™•ç†å­—ä¸²å€¼ï¼ˆå»é™¤å¼•è™Ÿï¼‰
                    let compareValue = value;
                    if ((value.startsWith("'") && value.endsWith("'")) || 
                        (value.startsWith('"') && value.endsWith('"'))) {
                        compareValue = value.substring(1, value.length - 1);
                    }
                    
                    // å˜—è©¦è½‰æ›ç‚ºæ•¸å­—ï¼ˆå¦‚æœå¯èƒ½ï¼‰
                    const rowValue = row[field];
                    const numericValue = isNaN(compareValue) ? compareValue : Number(compareValue);
                    const numericRowValue = isNaN(rowValue) ? rowValue : Number(rowValue);
                    
                    // åŸ·è¡Œæ¯”è¼ƒ
                    switch (operator) {
                        case '=':
                            return String(numericRowValue) === String(numericValue);
                        case '!=':
                            return String(numericRowValue) !== String(numericValue);
                        case '>':
                            return numericRowValue > numericValue;
                        case '<':
                            return numericRowValue < numericValue;
                        case '>=':
                            return numericRowValue >= numericValue;
                        case '<=':
                            return numericRowValue <= numericValue;
                        default:
                            return true;
                    }
                } catch (error) {
                    return true; // è§£æå¤±æ•—ï¼Œä¸éæ¿¾
                }
            });
        }

        // é¡¯ç¤ºæŸ¥è©¢çµæœ
        function displayResult(parsedQuery, result) {
            const tableName = parsedQuery.table;
            
            if (result.length === 0) {
                document.getElementById('resultArea').innerHTML = 'æŸ¥è©¢çµæœï¼š0 ç­†è¨˜éŒ„';
                document.getElementById('resultCount').innerHTML = '';
                showMessage('æŸ¥è©¢å®Œæˆï¼Œä½†æ²’æœ‰æ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„è¨˜éŒ„ã€‚', 'info');
                return;
            }
            
            // ç¢ºå®šè¦é¡¯ç¤ºçš„æ¬„ä½
            const displayColumns = parsedQuery.columns[0] === '*' ? 
                tableSchemas[tableName] : parsedQuery.columns;
            
            // ç”ŸæˆHTMLè¡¨æ ¼
            const resultHTML = generateTableHTML(tableName, result, displayColumns);
            
            document.getElementById('resultArea').innerHTML = resultHTML;
            document.getElementById('resultCount').innerHTML = `å…± ${result.length} ç­†è¨˜éŒ„`;
            
            // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
            const whereText = parsedQuery.where ? ` WHERE ${parsedQuery.where}` : '';
            const successMsg = `âœ… æŸ¥è©¢æˆåŠŸ: SELECT ${parsedQuery.columns.join(', ')} FROM ${parsedQuery.table}${whereText}`;
            showMessage(successMsg, 'success');
        }

        // ç”ŸæˆHTMLè¡¨æ ¼
        function generateTableHTML(tableName, data, displayColumns = null) {
            const columns = displayColumns || tableSchemas[tableName];
            
            let html = `<table>
                <thead>
                    <tr>`;
            
            // è¡¨é ­
            columns.forEach(col => {
                html += `<th>${col}</th>`;
            });
            
            html += `</tr>
                </thead>
                <tbody>`;
            
            // è¡¨æ ¼å…§å®¹
            data.forEach(row => {
                html += '<tr>';
                columns.forEach(col => {
                    html += `<td>${row[col]}</td>`;
                });
                html += '</tr>';
            });
            
            html += `</tbody>
            </table>`;
            
            return html;
        }

        // é¡¯ç¤ºè¨Šæ¯
        function showMessage(message, type = 'info') {
            const messageArea = document.getElementById('messageArea');
            
            let className = 'success-message';
            if (type === 'error') {
                className = 'error-message';
            } else if (type === 'info') {
                className = 'success-message';
                // ä¿®æ”¹èƒŒæ™¯è‰²ç‚ºä¿¡æ¯æç¤ºçš„é¡è‰²
                messageArea.innerHTML = `<div class="success-message" style="background-color: #e8f4fc; color: #3498db; border-color: #3498db;">${message}</div>`;
                return;
            }
            
            messageArea.innerHTML = `<div class="${className}">${message}</div>`;
            
            // 3ç§’å¾Œè‡ªå‹•æ¸…é™¤è¨Šæ¯ï¼ˆéŒ¯èª¤è¨Šæ¯é™¤å¤–ï¼‰
            if (type !== 'error') {
                setTimeout(clearMessage, 5000);
            }
        }

        // æ¸…é™¤è¨Šæ¯
        function clearMessage() {
            document.getElementById('messageArea').innerHTML = '';
        }

        // æ¸…é™¤çµæœ
        function clearResults() {
            document.getElementById('resultArea').innerHTML = 'è«‹è¼¸å…¥SQLæŸ¥è©¢æŒ‡ä»¤ä¸¦é»æ“Šã€ŒåŸ·è¡ŒæŸ¥è©¢ã€æŒ‰éˆ•';
            document.getElementById('resultCount').innerHTML = '';
            document.getElementById('sqlInput').value = '';
            clearMessage();
        }

        // åˆå§‹åŒ–é é¢
        function initPage() {
            // é è¨­è¼‰å…¥ä¸€å€‹æŸ¥è©¢ç¯„ä¾‹
            document.getElementById('sqlInput').value = "SELECT * FROM Students";
            
            // é¡¯ç¤ºæ­¡è¿è¨Šæ¯
            setTimeout(() => {
                showMessage('æ­¡è¿ä½¿ç”¨æ•¸æ“šåº«æ¨¡æ“¬å™¨ï¼è«‹è¼¸å…¥SQLæŸ¥è©¢æŒ‡ä»¤æˆ–ä½¿ç”¨å·¦å´çš„æŸ¥è©¢ç¯„ä¾‹ã€‚', 'info');
            }, 500);
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        window.onload = initPage;
    </script>
</body>
</html>